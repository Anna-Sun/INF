getwd()
setwd("u:/INF/doc")
# 24-8-2018 JHZ
options(width=160)
olink_panel <- function(xlsx, tabs, order, nlines, verbose)
{
for (x in tabs)
{
if (verbose) cat("\n\n", x, ":\n", rep("-", nchar(x)+1), "\n\n", sep="")
t <- openxlsx::read.xlsx(xlsx, sheet=x, colNames=TRUE, skipEmptyRows=FALSE, cols=c(1:16), rows=3:95)
s <- sub(" ", "_", x)
if (!order) assign(s, t, envir=.GlobalEnv) else
{
o <- order(t[,2])
assign(s, t[o,], envir=.GlobalEnv)
}
s <- get(s)
t <- "Target"
n <- names(s)
if (verbose)
{
print(head(s["Target"],nlines),right=FALSE)
cat("\n")
print(head(s[setdiff(n,t)],nlines))
}
}
}
xlsx <- "Olink validation data all panels.xlsx"
tabs <- "Inflammation"
olink_panel(xlsx,tabs,FALSE,92,TRUE)
inf.orig <- Inflammation
tabs <-c("Cardiometabolic","Cell Regulation","CVD II","CVD III","Development","Immune Response","Immuno-Oncology",
"Inflammation","Metabolism","Neurology","Oncology II","Organ Damage")
olink_panel(xlsx,tabs,TRUE,92,FALSE)
ls()
# grep inf1 olink.prot.list.txt | sed 's/inf1_//g;s/___/\t/g' > inf1.list
inf <- read.table("inf1.list",header=FALSE,col.names=c("prot","UniProt"),sep="\t",as.is=TRUE)
inf1 <- merge(inf,inf.orig,by.x="UniProt",by.y="UniProt.No.")
setdiff(inf$UniProt,inf.orig$UniProt.No.)
setdiff(inf.orig$UniProt.No.,inf$UniProt)
