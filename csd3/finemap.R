# 9-8-2019 JHZ

options(digits=3, scipen=20, width=500)
pr <- Sys.getenv("pr")
snpid_rsid <- Sys.getenv("snpid_rsid")
cat(pr, "\n")
snp <- read.table(paste0(pr, ".snp"), as.is=TRUE, header=TRUE)
config <- read.table(paste0(pr,".config"),as.is=TRUE,header=TRUE)
cred <- read.table(paste0(pr,".cred"),as.is=TRUE,header=TRUE)
load(paste0(snpid_rsid,".rda"))
library(openxlsx)
xlsx <- paste0(pr, "-finemap.xlsx")
unlink(xlsx, recursive = FALSE, force = TRUE)
wb <- createWorkbook(xlsx)
f <- make.names(pr)
addWorksheet(wb, "snpid_rsid")
writeDataTable(wb, "snpid_rsid", snpid_rsid)
addWorksheet(wb, paste0(f, ".snp"))
writeDataTable(wb, paste0(f, ".snp"), snp)
addWorksheet(wb, paste0(f, ".cfg"))
writeDataTable(wb, paste0(f, ".cfg"), config)
addWorksheet(wb, paste0(f, ".cs"))
writeDataTable(wb, paste0(f, ".cs"), cred)
saveWorkbook(wb, file=xlsx, overwrite=TRUE)
